<!DOCTYPE html>
<html>
<head>
	<title>Canvace</title>
	<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0" />
	<link href="http://fonts.googleapis.com/css?family=Titillium+Web:300" rel="stylesheet" type="text/css">
	<link href="/css/screen.css" rel="stylesheet" type="text/css" media="screen" />
	<link href="/css/mobile.css" rel="stylesheet" type="text/css" media="screen" />
	<link href="/css/pygments.css" rel="stylesheet" type="text/css" media="all" />
	<link href="/favicon.ico" rel="icon" type="image/vnd.microsoft.icon" />
</head>
<body>

<header class="header">
	<div class="inner">
		<a class="logo" href="/"><img src="/media/logo.png" alt="Canvace" /></a>
		<ul class="menu">
			<li><a href="/games/index.html">Games</a></li>
			<li><a href="/tutorials/index.html">Docs</a></li>
			<li><a href="http://api.canvace.com/">API</a></li>
		</ul>
	</div>
</header>

<a href="https://github.com/canvace"><img style="position: fixed; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub"></a>

<div class="contents">
<ol>
	
		
	
		
	
		
			<li>
				
					<a href='/tutorials/index.html'>Introduction and installation</a>
				
			</li>
		
	
		
			<li>
				
					Development environment
				
			</li>
		
	
		
			<li>
				
					<a href='/tutorials/init.html'>Rendering a stage in the canvas</a>
				
			</li>
		
	
		
			<li>
				
					<a href='/tutorials/entities.html'>Entities and collisions</a>
				
			</li>
		
	
		
			<li>
				
					<a href='/tutorials/pathfinding.html'>Pathfinding and animations</a>
				
			</li>
		
	
		
			<li>
				
					<a href='/tutorials/input-view.html'>Input events and stage's view</a>
				
			</li>
		
	
		
			<li>
				
					<a href='/tutorials/effects.html'>Special effects</a>
				
			</li>
		
	
		
			<li>
				
					<a href='/tutorials/state-machine.html'>State machines</a>
				
			</li>
		
	
		
			<li>
				
					<a href='/tutorials/sound.html'>Sound effects</a>
				
			</li>
		
	
		
			<li>
				
					<a href='/tutorials/http-compression.html'>Enabling HTTP compression</a>
				
			</li>
		
	
</ol>
<h1 id='the_development_environment'>The development environment</h1>

<p>In this chapter, I will explain how to use the game editor provided by Canvace to set up a single level for an isometric game. First, you need to install Canvace and make the editor accessible to a webserver: follow THIS GUIDE.</p>

<p>Once the installation is complete and the editor is running, the first step is creating a new stage using <strong>Create stage</strong>. Each stage represents one level in the game. Click on the newly-created stage in the list to open the editor.</p>

<h2 id='projection_matrix'>Projection matrix</h2>

<p>When creating a new stage, the projection matrix needs to be defined. You can either select the default one, or define a custom 3x3 matrix: note that for now the last row must always be inserted at hand, whereas the other elements are indirectly modified by Canvace when the adjacent graphical representation is changed. For isometric games, the default projection matrix transforms the 3d map coordinates of the elements (in Canvace referred to as i, j and k) into window coordinates for the canvas (x, y and z, where the depth z is used to avoid drawing objects hidden by closer ones).</p>

<p>When using the default projection matrix in isometric games, an issue may arise. Consider two adjacent tiles and an entity placed as in the following figure (seen from above):</p>

<p><img alt='Tiles' src='images/isometric.png' /></p>

<p>The point identifies the location of the entity, but the entity frame is bigger and actually spawns across the two tiles (circle around the point). The predefined projection matrix computes the canvas z coordinate as the sum of the i, j and k coordinates. You can see that Tile1 and Tile2 have the same j and k coordinate, but Tile1 has an higher i coordinate. Therefore, when the canvas content is rendered, Tile1 is regarded as being placed behind Tile2. If an entity frame occupies both Tile1 and Tile2, the section on Tile1 will be hidden, resulting in a ugly effect, typically when the entity is moving from one tile to the next.</p>

<p>In order to avoid this, pavement tiles must be configured and stamped as roof of a layer placed below the default one. Graphically speaking, nothing changes, but the issue is solved, because now both tiles have a lower k coordinate, different from that of the entity. RIVEDERE!!!</p>

<h2 id='editing_the_game_environment'>Editing the game environment</h2>

<p>SCREENSHOT OF EDITOR</p>

<p>All the pictures used for the game environment and characters have to be first imported in the editor. This is done in the tab <strong>Images</strong> of the lower panel.</p>

<p>SCREENSHOT OF LOWER PANEL, IMAGES TAB</p>

<p>Select <strong>Import images</strong>. This opens a dialog where you can import up to 1024 images from the hard drive. It&#8217;s quite useful to group together images belonging to the same category by assigning them one or more comma-separated labels.</p>

<p>Next, we need to create tiles, which will form the ground or floor of our game map.</p>

<p>SCREENSHOT OF TILES TAB</p>

<p>A tile can be created by choosing the <strong>Create new tile</strong> button. We keep the default dimension for tiles: in our game, each tile spawns over a single map square.</p>

<p>SCREEN OF FIRST OPTIONS</p>

<p>Whether a tile is solid or not influences the feasible movements of our units: therefore, all tiles containing buildings or grass are solid, whereas for road tiles we disable this option, as we want our characters to be able to move on them. To define the appearance of the tile, we add a frame to it. When adding a frame, you can choose the picture that represents it; this is where labeled images come in handy, since you can choose to view only the images belonging to certain categories. For example, for tiles we used only pictures labeled as &#8220;world,ground&#8221;.</p>

<p>SCREENSHOT OF DIALOG WITH FRAMES</p>

<p>No additional properties are needed for our game, and so we close the dialog. These settings can however be modified later by double-clicking on the tile. After the tiles have been created, we set up a little &#8220;town&#8221; by adding them to the map. This is done by selecting the desired tile, and then the <strong>Stamp tile</strong> drawing tool. It is now possible to &#8220;stamp&#8221; tiles around the game map. You may notice it is possible to stamp a tile on top of an existent one: the newer one will simply overwrite it. It is also possible to erase tiles from the map (restoring a blank square) with the eraser tools.</p>

<p>Now that the generic environment has been designed, we add our game characters as <strong>Entities</strong>. Entities (unlike tiles) aren&#8217;t bounded in specific map squares, but they can appear in any point of the map, and can be moved around as the game advances. Apart from this, the creation process is quite similar to the one we followed for tiles: a new entity is created and a picture is associated to it. Additionally, in the setting panel, the physics has been enabled for every entity. This is useful when developing the game logic, as it gives quick and easy access to a set of features that control the movements of the entities. Entities and tiles may have custom properties associated to it, depending on your game&#8217;s needs: however, remember that string properties must always be enclosed in double quotes. Here we assigned a &#8220;name&#8221; string property to all the entities, needed to identify them later.</p>

<p>SCREEN WITH PHYSICS</p>

<p>As above, entities can be stamped in the desired initial positions with <strong>Stamp entity</strong>, and subsequently erased. Entities can also be moved around using the <strong>Move entity</strong> drawing tool. This is the final appearance of the game level:</p>

<p>FINAL SCREEN</p>

<p>Looking at the right panel, you may notice there are actually two layers here: &#8220;layer 0&#8221;, the default ones, contains the tiles, while &#8220;layer 1&#8221; contains the entities. This is a trick employed in order to avoid the issue with isometric games described in the introduction of this page. Layers of course can be created also to make a game extend on the third dimension.</p>

<p>The changes made to the stage are saved using the <strong>Save</strong> button. As soon as the level environment is completed and saved, it needs to be exported in a format recognizable by Canvace. This is done in the <strong>Stage</strong> bar: specifically, &#8220;Download images&#8221; exports all the pictures used in an archive, while &#8220;Download JSON&#8221; exports a JSON file containing the stage information, found HERE.</p>
<hr />


<div id="disqus_thread"></div>
<script type="text/javascript">
	var disqus_shortname = 'canvace';

	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>

<footer class="footer">
	<div class="inner">
		<div>
			Canvace Srl - Via Luigi Casale, 7 - 05100 Terni (Italia) - VAT/P. IVA 01485160558
			&nbsp;
			<a href="https://www.iubenda.com/privacy-policy/863492" class="iubenda-black iubenda-embed" title="Privacy Policy">Privacy Policy</a>
		</div>
		<script type="text/javascript">(function (w,d) {var loader = function () {var s = d.createElement("script"), tag = d.getElementsByTagName("script")[0]; s.src = "https://cdn.iubenda.com/iubenda.js"; tag.parentNode.insertBefore(s,tag);}; if(w.addEventListener){w.addEventListener("load", loader, false);}else if(w.attachEvent){w.attachEvent("onload", loader);}else{w.onload = loader;}})(window, document);</script>
		<div>
			<a href="http://enlabs.it/" target="_blank"><img src="/media/enlabs.png" alt="Powered by EnLabs" /></a>
		</div>
	</div>
</footer>

</body>
</html>
